{
    "create_table_raw_data": "CREATE TABLE raw_data (\n    id SERIAL PRIMARY KEY,\n    epoch BIGINT NOT NULL UNIQUE,\n    timestamp TIMESTAMP WITHOUT TIME ZONE NOT NULL,\n    open NUMERIC(10, 2) NOT NULL,\n    high NUMERIC(10, 2) NOT NULL,\n    low NUMERIC(10, 2) NOT NULL,\n    close NUMERIC(10, 2) NOT NULL,\n    volume NUMERIC(10, 6) NOT NULL\n);"
    ,"truncate_table_raw_data":"truncate table raw_data"
    ,"create_agg_view5": "create or replace view agg_view5 (start_epoch, end_epoch, start_time, end_time, open, close, low, high, volume) as (\n    WITH intervals AS (\n        SELECT \n            epoch/300*300 as start_epoch,\n            max(epoch) as end_epoch,\n            max(high) as high,\n            min(low)  as low,\n            sum(volume) as volume\n        FROM \n            raw_data\n        GROUP BY \n            epoch/300*300\n    )\n    select i.start_epoch, i.end_epoch, to_timestamp(i.start_epoch) as start_time, to_timestamp(end_epoch) end_time,\n        sd.open as open, sdd.close as close, i.low as low, i.high as high, i.volume as volume\n        from intervals  i \n        left join raw_data  sd \n            on i.start_epoch= sd.epoch\n        left join raw_data sdd \n            on i.end_epoch = sdd.epoch\n);"
}
